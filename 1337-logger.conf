# Log vector clock log messages to fil
template(name="outfmt" type="list") {
    property(name="timestamp" dateFormat="rfc3339")
    constant(value=" ")
    property(name="hostname")
    constant(value=" ")
    property(name="syslogtag")
    property(name="msg" spifno1stsp="on" )
    property(name="msg" droplastlf="on" )
    constant(value="\n")
}

# outputformat with unixtime with subseconds for better comparison
$template unixtimestamp_highres,"%TIMESTAMP:::date-unixtimestamp%%TIMESTAMP:21:24:date-rfc3339% %HOSTNAME% %syslogtag%%msg%\n"

# outputformat with short timestamp + unixtime with subseconds for better comparison
$template normal_unixtimestamp_highres,"\
%TIMESTAMP:::date-year%.%TIMESTAMP:::date-month%.%TIMESTAMP:::date-day% \
%TIMESTAMP:::date-hour%:%TIMESTAMP:::date-minute%:%TIMESTAMP:::date-second% \
%TIMESTAMP:::date-unixtimestamp%%TIMESTAMP:21:24:date-rfc3339% \
%HOSTNAME% %syslogtag%%msg%\n"

if ($msg contains '/VC:') then {
   action(type="omfile" file="/var/log/vc.log" template="outfmt")
   action(type="omfile" file="/var/log/vc_uxhr.log" template="unixtimestamp_highres")
   action(type="omfile" file="/var/log/vc_norm_uxhr.log" template="normal_unixtimestamp_highres")
}
